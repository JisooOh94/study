# Spring 의존성 주입 방식
# 수정자(setter) 주입
### bean 직접 등록할때의 수정자 주입
* <bean> 태그로 bean 등록시, <property> 파라미터를 통해 주입
* <property> 파라미터에 name(수정자 파라미터 명), ref 명시(주입할 bean name) 필요
```java
//Foo.class
public class Foo {
	private Bar bar;
	public void setBar(Bar barParam) {
		this.bar = barParam;
	}
}

//ApplicationContext.xml
<bean id="foo" class="com.naver.Foo">
	<property name="barParam" ref="barBean">
</bean>

<bean id="barBean" class="com.naver.Bar" />
```
* <property> 태그의 ref 파라미터대신 val 파라미터 사용하여 값(value) 주입도 가능
```java
//Foo.class
public class Foo {
	private String str;
	public void setStr(String str) {
		this.str = str;
	}
}

//ApplicationContext.xml
<bean id="foo" class="com.naver.Foo">
	<property name="str" val="TestString">
</bean>
```
* Spring 2.5 버전 이상일경우, <property> 태그 대신 <bean> 태그의 p 파라미터로 대체 가능
	* <property name="paramName" ref="beanName"> -> <bean p:paramName-ref="beanName" />
	* <property name="paramName" val="value"> -> <bean p:paramName="value" />
```java
<bean id="foo" class="com.naver.Foo" p:barParam-ref="barBean"/>
<bean id="foo" class="com.naver.Foo" p:str="testString"/>
```

### 어노테이션을 통한 bean 자동등록할떄의 수정자 주입
* 수정자(setter) 에 @Autowired 어노테이션만 추가
* IoC 컨테이너가 자동으로 수정자 파라미터명, 타입과 동일한 bean을 찾아 주입
```java
@Component
public class Foo {
	private Bar bar;
	
	@Autowired
	public void setBar(Bar barParam) {
		this.bar = barParam;
	}
}

@Component("barParam")
public class Bar {}
```
* @Autowired 대신 @Resource 어노테이션으로 대체 가능
	* @Resource 어노테이션은 주입받을 bean name 을 파라미터로 지정 가능
```java
@Resource("barParam")
public void setBar(Bar bar) {
	this.bar = bar;
}
```
> cf) bean 새성시 <bean> 태그 파라미터
>* \<bean id="" name=""">
>* id : 각 bean 마다 1개만 가질 수 있는 고유한 id
>* name : bean 마다 여러개를 가질 수 있는 별명

> cf) bean 주입시 <ref> 태그 파라미터 
>* \<ref local="beanId">
>* 주입받는 빈과 동일한 xml 파일에 등록되어있는 빈만 주입가능
>* 각각의 빈의 고유한 id 속성으로만 주입 가능
>* \<ref bean="beanName">
>* 주입받는 빈과 다른 xml 파일에 등록되어있는 빈이라도 주입 가능
>* 빈의 id 속성 뿐만아니라 name(별칭)속성값으로 검색하여 주입

```java
<bean id="foo" name="fooA,fooB" class="com.naver.Foo">

<bean id="bar" class="com.naver.Bar">
	<property name="foo">
		<ref local="foo"/>
	</property>
</bean>

<bean id="bar" class="com.naver.Bar">
	<property name="foo">
		<ref bean="foo"/>
		<ref bean="fooA"/>
		<ref bean="fooB"/>
	</property>
</bean>
```

<br>

# 생성자 주입
### bean 직접 등록할때의 생성자 주입
* <bean> 태그로 bean 등록시, <constructor-arg> 파라미터를 통해 주입
* <property> 태그와 달리 파라미터로 ref(또는 value) 만 명시 (ref 의 타입과 이름을 기반으로 생성자 선택 및 주입)
```java
public class Foo {
	private Bar bar;
	
	public Foo (Bar bar) {
		this.bar = bar;
	}
}

<bean id="foo" class="com.naver.Foo">
	<constructor-arg ref="bar">
</bean>

<bean id="bar" class="com.naver.Bar"/>
```

* <constructor-arg> 태그로 여러개의 파라미터를 주입할 경우, 생성자에 정의되어있는 파라미터 순서에 맞춰주거나 혹은 index 파라미터로 직접 순서 명시
```java
public Foo (String str, Bar bar) {
	this.str = str;
	this.bar = bar;
}
//순서 맞추는 방식
<bean id="foo" class="com.naver.Foo">
	<constructor-arg value="testStr">
	<constructor-arg ref="bar">
</bean>
//index 명시 방식
<bean id="foo" class="com.naver.Foo">
	<constructor-arg ref="bar" index="1">
	<constructor-arg value="testStr" index="0">
</bean>
```

* <constructor-arg> 태그로 value 를 주입할경우, value 의 타입에 상관없이 모두 String 으로 변환후 주입된다. 따라서 원하는 값 타입으로 주입되길 원하는경우, value 파라미터와 함께 type 도 명시 필요
```java
public Foo (String str, int num) {
	this.str = str;
	this.num = num;
}

<bean id="foo" class="com.naver.Foo">
	<constructor-arg value="testStr">
	<constructor-arg type="int" value="3"/>
</bean>
```

* Spring 2.5 버전 이상일경우, <constructor-arg> 태그 대신 <bean> 태그의 c 파라미터로 대체 가능
	* <constructor-arg ref="beanName"> -> <bean c:paramName-ref="beanName" />
	* <constructor-arg value="value"> -> <bean c:paramName="value" />
```java
<bean id="foo" class="com.naver.Foo" c:bar-ref="bar"/>
<bean id="foo" class="com.naver.Foo" c:str="testString"/>
```
 
### 어노테이션을 통한 bean 자동 등록할때의 생성자 주입
* 생성자 에 @Autowired 어노테이션만 추가
* IoC 컨테이너가 자동으로 생성자 파라미터 명,타입과 동일한 bean을 찾아 주입
```java
@Component
public class Foo {
	private Bar bar;
	
	@Autowired
	public Foo (Bar bar) {
		this.bar = bar;
	}
}

@Component
public class Bar {}
```

<br>

# 필드 주입
* 수정자, 생성자를 통하지 않고 협력객체 참조변수 필드에 바로 주입되는 방식
* 필드에 @Autowired 어노테이션 추가 (필드가 bean이 아닌, 값일경우 @Value 어노테이션)
* IoC 컨테이너에서 Java reflection 을 이용하여 bean이나 value 주입
```java
public class Foo {
	@Autowired
	private Bar bar;
	@Value("testStr")
	private String str;
}
``` 