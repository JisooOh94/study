# 다중 트랜잭션
* 하나의 웹애플리케이션이 여러개의 데이터베이스와 통신할때의 트랜잭션 처리 방법

### 데이터베이스 개별적 트랜잭션
* 각각의 데이터베이스 통신에 개별적으로 트랜잭션을 적용할 수 있도록 여러개의 TransactionManager 정의하는 방법

1.각각의 데이터베이스 dataSource 빈 등록
```xml
<bean id="dataSource_oracleDB" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close">
	...
</bean>

<bean id="dataSource_mySqlDB" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close">
	...
</bean>
```

2.각각의 dataSource 를 파라미터로 데이터베이스 transactionManager 빈 등록
```xml
<bean id="transactionManager_oracleDB" class="org.springframework.jdbc.datasource.DataSourceTransactionManager">
	<property name="dataSource" ref="dataSource_oracleDB">
</bean>

<bean id="transactionManager_oracleMySqlDB" class="org.springframework.jdbc.datasource.DataSourceTransactionManager">
	<property name="dataSource" ref="dataSource_mySqlDB">
</bean>
```

3.\<tx:annotation-drive> 태그도 데이터베이스 수만큼 선언하여 각각의 transactionManager 를 'transaction-manager' 로 전달하여 명시
```xml
<tx:annotation-driven transaction-manager="transactionManager_oracleDB"/>
<tx:annotation-driven transaction-manager="transactionManager_mySqlDB"/>
```

4.메서드/클래스에 @Transactional 어노테이션 추가하며 transactionManager 파라미터로 트랜잭션에 사용할 transactionManager 명시
```java
@Autowired
private JdbcTemplate oracleJdbcTemplate;
@Autowired
private JdbcTemplate mySqlJdbcTemplate;

@Transactional(transactionManager = "transactionManager_oracleDB")
public List<String> getUserIdFromOracleDB() {
	oracleJdbcTemplate.queryForList();
}

@Transactional(transactionManager = "transactionManager_mySqlDB")
public List<String> getUserAgeFromMySqlDB() {
	mySqlJdbcTemplate.queryForList();
}
```  

### 데이터베이스 융합 트랜잭션
* 하나의 트랜잭션 내에서 여러 데이터베이스와 통신해야하는 경우의 트랜잭션 적용 방법
