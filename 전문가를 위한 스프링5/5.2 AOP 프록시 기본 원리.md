# AOP 프록시 기본 원리
### 에스펙트 객체 생성 과정
* 어드바이스를 적용할 조인포인트에 따라 적절한 Interceptor 인터페이스 구현
	* e.g. 조인포인트가 메서드 명시적 호출일시 MethodInterceptor 인터페이스 구현
```java
public class UserDefineMethodAspect implements MethodInterceptor {
}
```

* 인터셉터 구현시 조인포인트 로직 수행 주체를 파라미터로 받는 어드바이스 메서드 구현
	* e.g. MethodInterceptor 구현시, 조인포인트 로직 수행 주체가 메서드 호출 객체 이므로 MethodInvoation 을 파라미터로 받음
```java
public class UserDefineMethodAspect implements MethodInterceptor {
	public Object invoke(MethodInvoation invoker) {
	}
}
```
* 어드바이스 메서드 구현시 조인포인트 로직 수행 주체의 proceed 메서드 호출 이전/이후에 어드바이스 코드 추가
	* e.g. 메서드 수행 이전에 로깅을 추가하고 싶을경우, MethodInvoker.proceed() 호출 이전에 로깅 코드 추가
```java
public class UserDefineMethodAspect implements MethodInterceptor {
	public Object invoke(MethodInvoation invoker) {
		Logger.debug("Logging Advice");		//횡단 관심사
		
		invoker.proceed(); 		//런타임 메서드 수행
	}
}
```

### 동적 AOP의 에스펙트 위빙 과정
1. AOP를 적용하고자 하는 객체의 프록시객체를 생성할 ProxyFactory 인스턴스 생성
2. ProxyFactory의 .addAdvice 메서드로 객체에 적용할 에스펙트 추가
3. ProxyFactory의 setTarget 메서드로 AOP 적용할 객체 인스턴스 설정
4. ProxyFactory의 getProxy 메서드로 타겟 객체 타입 프록시 객체 생성
5. 프록시 객체로 액셔 요청시, 프록시에 등록되어있는 Advisor(에스펙트) 들중, 요청된 액션 시점과 일치하는 조인포인트를 가지고있는 Advisor 의 Advise 위빙
6. Spring AOP 에선 의존성 주입시, 협력객체를 감싸고있는 프록시 객체를 대신 주입하여 AOP 적용

### ProxyFactory
* 위빙 및 프록시 생성 과정 제어
* setTarget : AOP 를 적용할 객체 인스턴스 설정
* setAdvise
	* 조인포인트에 수행할 횡단관심사 구현 객체 설정
	* setTarget 으로 지정한 클래스의 모든 메서드에 AOP 적용하고자 할시 사용
		* 지정한 어드바이스 객체를 파라미터로 DefaultPointcutAdvisor 어드바이서(에스펙트) 생성
		* DefaultPointcutAdvisor 는 클래스의 모든 메서드에 적용됨
* setAdvisor
	* 클래스의 특정 메서드 또는 특정 상황일때에만 AOP 적용하고자 할 시 사용
	* AOP 를 적용할 메서드나 상황을 직접 설정한 사용자 정의 Advisor 객체 생성후 setAdvisor 를 통해 ProxyFactory에 전달 

> cf) Advisor
> * Proxy 객체 내부에서 사용하는 에스펙트 구현체
> * 어드바이스 + 어드바이스를 수행할 포인트 컷 으로 구성

### Spring AOP 특징
* Spring AOP 에선 메서드 조인포인트만 지원
	* 메서드에 대해서만 AOP 를 적용할수 있다는 제약이 있으나 그만큼 구조가 단순하고 사용하기 쉬움
	* 메서드 조인포인트 외에 다른 조인포인트에 AOP 적용이 필요할경우 AspectJ AOP 와 함께 사용 가능
* Spring에서 제공하는 메서드 조인포인트 Advisor 구현체
	* Before
	* After-Running
	* After
	* Around
	* Throws
	* Introduction