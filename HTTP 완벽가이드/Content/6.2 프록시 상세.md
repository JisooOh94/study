# 프락시 서버 요청 uri
* 클라이언트에서 프락시 서버로 요청 메시지를 전달할시, 요청줄의 uri에 full path(scheme://host:port/uri 작성
* 프락시 서버는 요청 수신후, 요청줄에 full path 로 작성되어있는 원서버 host에 요청 전달

```
클라이언트 > 웹서버
GET /index.html HTTP/1.0

클라이언트 > 프락시 서버
GET http://www.test-drive-ems01.ncs.ncl.com/index.html HTTP/1.0
```
<br>

# 다목적 프락시
* 클라이언트가 웹서버로 전송한 요청 메시지를 중간에 가로채는 인터셉트 프락싱의 경우 요청메시지의 uri가 부분 uri로 되어있음
* 인터셉트 프락시와 같은 다목적 프락시는 full path uri, 부분 uri 모두 대응 가능해야함
### 부분 uri 대응
* 클라이언트가 요청 메시지 헤더에 웹서버 주소를 작성하는 호스트 헤더 이용
* 요청메시지 uri가 부분 uri 일 경우, 호스트 헤더 를 참조하여 원서버 주소 및 포트번호 획득
* 요청메시지 uri가 부분 uri 이고 호스트 헤더가 존재하지 않을경우, 업스트림 서버 주소 탐색 수행
   1. 프락시 서버가 대리 프락시일 경우, 프락시 자체적으로 저장하고 있는 업스트림 서버 주소, 포트 번호 사용
   2. 이전에 또다른 인터셉트 프락시가 가로채어 작업 후 현 서버로 프락시 해준경우, 앞단의 인터셉트 프락시에 기록되어있는 업스트림 서버 주소, 포트 번호 사용
   3. 탐색이 모두 실패시, 에러메시지 응답

<br>

# URI 자동 확장
* 사용자가 축약한 형태의 호스트 주소를 요청하였을 시, 브라우저에서 자동으로 유효한 호스트 주소로 변환하는 과정
* 일부 브라우저에선 오타가 있는 호스트 주소를 교정하여 사용자가 의도했을 호스트 주소로 변환하는 기능 제공
### URI 자동 확장 과정
1. 입력한 호스트 주소에 스킴(http://), 포트번호(80), uri(/) 가 생략되어있다면 추가
2. 스킴과 포트번호, uri를 추가한 호스트 주소로 DNS에 IP 주소 요청
3. DNS로부터 IP주소 탐색 실패 응답 수신 시, 호스트 주소에 접두사 www, 접미사 .com 을 추가하여 재 요청
4. IP 주소 탐색 실패시, 서드파티 사이트로 호스트 주소를 전송하여 오타 교정 시도

### 프락시 서버를 통한 요청시 URI 확장
* 클라이언트가 명시적 프락시와 통신시, 브라우저는 자동 uri 확장을 수행하지 않음
* 따라서 부분 호스트명으로 프락시 서버에 요청시, 서버 IP주소 탐색 실패 에러 발생
* 명시적 프락시가 아닌 프락시(eg. 인터셉트프락시)와의 통신시 브라우저에서 자동 uri 확장 수행
<br>


# 메시지 추적
* 클라이언트의 요청이 원서버에 도달할때까지 거쳐간 프락시/게이트웨이 경로와 각 프락시에서 수행한 작업들에 대한 추적
### via 헤더
* 요청이 거쳐간 중계 서버(프락시/게이트웨이)들의 경로 기록
* 요청이 중계서버에 도달했을 때, 중계서버는 자신에 대한 정보를 via 헤더 필드 뒤에 추가 ( , 로 구분)
```
via: 1.1 test-drive-ems01.ncl, FTP/1.0 test-drive-ftp.ncl:8009
```
* 포맷 : 프로토콜 종류 / 프로토콜 버전 / 호스트 명 및 포트번호 / 코멘트
1. **프로토콜 종류**
   * 중계서버에 전달된 요청메시지의 프로토콜
   * http 일 경우 생략
2. **프로토콜 버전**
   * 중계서버에 전달된 요청메시지 프로토콜 버전
3. **호스트 명 및 포트번호**
   * 중계서버 호스트 명 및 포트번호
   * 포트번호가 80일경우 생략 가능
4. **코멘트**
   * 중계 서버에 대한 추가적인 설명
   * 생략 가능

### TRACE 메서드
* 중계 서버들이 전달된 요청메시지에 대해 수행한 작업 기록
* 중계서버들을 거쳐 원서버에서 요청메시지 수선시, 원서버는 전달받은 요청메시지를 응답메시지 본문에 저장하여 클라이언트에게 전송

<br>

# Options
* 지정한 uri에 대해 웹서버가 지원하는 Http 메서드 종류를 요청하는 메서드
* 응답메시지 Allow 헤더에 요청메시지에서 명시한 uri 에 대해 지원하는 Http 메서드 종류 명시
   ```
   <요청 메시지>
   요청줄 : OPTIONS /root/index.html HTTP/1.1
   <응답 메시지>
   응답 헤더 : Allow : GET, POST, DELETE
   ```

* uri가 * 일경우 모든 uri에 대해 서버가 지원하는 모든 Http 메서드 종류 응답
* 요청 메시지에 Allow 헤더가 있는경우, 클라이언트에서 서버에게 명시한 uri에 대해서 허용해주길 바라는 메서드를 명시한 것. ( 서버가 반드시 들어줄 필요는 x)
<!--stackedit_data:
eyJoaXN0b3J5IjpbLTIwOTY0NTcyOTddfQ==
-->