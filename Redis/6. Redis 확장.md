# 저장
* 메모리에 저장되기에 강제 종료 및 에러에 취약 = 데이터 손실
* 레디스 데이터베이스 or  Append-Only File을 제공 (1개의 레디스 인스턴스에서 개별적 or 동시 사용) 

# 레디스 데이터베이스(RDB)
* .rdb 파일
* 특정 시점의 데이터 바이너리
* 빠른 읽기 , 쓰기에 최적화
* .rdb 파일 내부 구조 = 레디스 인메모리 구조와 비슷
* RDB 압축시 LZF 압축 사용

# SAVE 커맨드
* RDB 파일 즉시 생성 
* 스냅샷과정에서 레디스 서버 블록하기에 사용 주의
* BGSAVE(백그라운드 저장) 사용 필요 (fork) 
* redis.conf 파일 수정을 통해 스냅샷 규칙 설정

### 스냅샷 대체 
* redis.conf 의 모든 save 지시자 삭제 or 주석 후 서버 재시작
* 커맨드라인 옵션 or CONFIG SEt 커맨드로 설정 변경
### 스냅샷 대체의 단점
* 매분 스냅샷 저장하더라도, RDB는 데이터 복구를 100% 보장 못함
* 스냅샷 생성 시, Fork작업 수행, 밀리초 or 초 동안 클라이언트 멈춤 현상 발생 

# AOF(Append-Only-File)
* 활성화 시(redis.conf = appendonly 설정 Yes or No ) 
* 데이터 집합 변경하는 커맨드(입력 / 수정  / 삭제)  받을 때 마다 AOF 파일에 해당 커맨드 추가
* GET 같은 읽기(조회)명령은 AOF 기록 하지 않음 
* AOF에 커맨드 저장, 재 시작 시 AOF에 나열된 모든 커맨드 순차적으로 실행하여 복구
* 일종의 로그 파일
* AOF가 불완전하거나 손상 되는 경우 redis-check-aof tool을 사용할 수 있음
* ( 성능 비용 존재 및 추가 디스크 공간 필요 ) 
* BGREWRITEAOF 커맨드 통해 수동으로 작은 버전 최적화 or 옵션을 사용해 작은 버전으로 최적화 (수동으로 aof 파일을 쓰게 만드는 명령어) 
* AOF 파일 저장(rewrite)하는 동안 크래시 발생 시 원본 AOF 파일은 변경 되지 않음
*  레디스 시작 시, RDB와 AOF 파일 중 하나라도 존재하면 로드
    * 모두 존재 시, AOF가 우선권을 가짐
### 케이스
- 저장이 필요하지 않다면 RDB와 AOF를 비활성화
- 약간의 데이터 손실이 허용되면 RDB 사용
- 내구성 있는 저장이 필요하다면 RDB와 AOF 둘다 사용 