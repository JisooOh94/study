# Redis Replication
* Master-Slave 형식의 데이터 이중화 구조로서 데이터 복제를 통해 고가용성을 제공하기 위한 장치
* 하나의 Redis 인스턴스가 마스터 역할을 하고, 하나 이상의 슬레이브 인스턴스가 마스터의 데이터를 복제하여 보관

### Master-Slave
* Master : 데이터 원본 저장 및 모든 쓰기 연산 처리
* Slave : 비동기적으로 마스터 데이터 복제 및 읽기 연산 처리

## 동작 방식

### 초기복제
* 슬레이브가 처음 마스터에 연결되면, 마스터는 현재의 데이터 스냅샷(RDB 파일)을 생성하여 슬레이브로 전송, 슬레이브는 이 스냅샷을 받아서 메모리에 로드

### 실시간 복제
* 초기 복제가 완료된 후, 마스터는 모든 쓰기 연산을 슬레이브에게 전송
* 슬레이브는 이 연산을 그대로 수행하여 마스터와 동일한 데이터를 유지
* 복제는 비동기적으로 이루어지기 때문에, 슬레이브 데이터는 일시적으로 마스터와 일치하지 않을 수 있음 (Eventual Consistency)

### Failover
* 마스터가 장애를 일으키면, 슬레이브 중 하나를 새로운 마스터로 승격
  * 주로 Redis Sentinel을 통해 자동으로 슬레이브를 마스터로 승격
* 새로운 마스터가 설정되면, 다른 슬레이브는 새로운 마스터로부터 데이터를 복제


## 장점
### 고가용성
* 마스터가 장애를 일으키더라도 슬레이브가 데이터를 보관하고 있어 데이터 유실 방지 가능
* 마스터 장애시 슬레이브를 마스터로 승격하여 서비스 중단 최소화, 고가용성 보장

### 읽기 성능 향상
* 읽기 요청을 슬레이브로 분산시켜 마스터의 부하 감소
* 슬레이브 scale-out 을 통해 읽기 성능을 수평적으로 확장 가능


## 단점
### 일관성 문제
* Eventual consistency(복제가 비동기적으로 수행) 이기때문에, 슬레이브 데이터는 일시적으로 마스터와 일치하지 않을 수 있음
  * 캐시 무효화 전략(캐시 수정전, 캐시 엔트리 삭제 먼저 수행) 등을 통해 어느정도 완화 가능

### 쓰기 성능 제한
* 모든 쓰기 연산은 마스터에서만 처리되기 때문에, 마스터의 쓰기 성능이 시스템 전체의 쓰기 성능 제한
* 가급적 Read-heavy 한 서비스에 사용 권장
* Redis Cluster 를 통해 쓰기 성능 어느정도 개선 가능
