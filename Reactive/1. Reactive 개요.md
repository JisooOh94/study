# Reactive 기본 개념
* 옵저버 패턴 기반의 논블로킹 비동기 방식 사용자 요청 처리 방법
* 사용자 요청 처리 과정에서 수행되는 IO 작업들을 논블로킹, 비동기적으로 수행함으로서 스레드 및 자원을 효율적으로 사용

### AS-IS(Blocking, Sync)
![image](https://user-images.githubusercontent.com/48702893/109412880-e4eed700-79ed-11eb-977e-a9b960318dca.png)
* 응답시간 : 각 IO 작업 수행시간의 총합

### TO-BE(Non-Blocking, Async)
![image](https://user-images.githubusercontent.com/48702893/109412882-e7513100-79ed-11eb-8d43-d18b2786486d.png)
* 응답시간 : IO 작업중 가장 오래 걸린 작업의 수행시간


<img src="https://user-images.githubusercontent.com/48702893/128733391-1346d4ea-f67b-434f-9b18-713d3407f88c.png" width="500" height="300">

<br>

# 등장 배경
### MSA 및 분산시스템
* 시스템이 분산됨에 따라 API 호출, 데이터 엑세스등의 IO 수행시간 대폭 증가

### 멀티스레딩의 한계
* 복잡한 임계영역을 개발자가 직접 컨트롤해야하므로 개발이 어려워지고 버그 가능성도 높아짐
* 멀티스레딩을 이용한 기존의 비동기 방식은 IO 작업 수행중 스레드를 점유하여 컨텍스트 스위칭으로 인한 비효율 발생 및 스레드풀 스레드 부족 문제 발생 가능
	* Reactive 는 Event driven 방식으로 동작하여 스레드 점유 없이 Async 하게 처리(Event Listener, Event Handler 사용)
		1. 메인 스레드에선 IO 작업 요청 후 바로 return 하여 다른 작업 수행 <br>
		2. Observer(Event Listener) 에서 IO 응답 수신시 Event Handler 에게 처리 위임 <br>
			2.1 응답 서버가 응답 준비되었다고 Observer 에게 noti 전송 <br>
			2.2 Observer 는 가용한 처리량만큼 응답 서버에게 데이터 요청(백프레셔)
		3. Event Handler 에선 call back 함수를 Event Queue 에 등록 <br>
		4. Event Loop 가 call stack 이 비어있는지 확인하여 Event Queue에 등록되어있는 call back 함수를 call stack으로 옮겨 수행

> 용어정리 <br>
> Lisener : 옵저버 패턴을 활용해 만든 인터페이스 <br>
> Callback : Publisher 가 Subscriber(Observer) 에게 noti를 전송하는것. Observer 는 noti 수신 후 등록된 Callback 메서드 수행

![event-loop](https://user-images.githubusercontent.com/48702893/129528788-c0374bff-8735-4d9e-8c69-021a62b0d642.gif)

<br>

# 장점
### 논블로킹
<img src="https://user-images.githubusercontent.com/48702893/129197508-0e126286-7b34-41dd-b684-694c20fe98b8.png" width="500" height="300">

* 적은 리소스(쓰레드, CPU, 메모리, 네트워크 등)로 더 많은 요청 처리 가능
* 논블로킹 IO로 동작하기 떄문에 IO 작업이 스레드를 점유하지 않아 의존 컴포넌트의 장애에 Resilient 함

### 백프레셔
* Elastic
* MSA 를 통해 컴포넌트가 쪼개질수록 그 효과는 극대화
* Event Driven 아키텍쳐의 장점 흡수

<br>

# 단점
* 코드 가독성 저하
* 테스트의 어려움
* 높은 러닝 커브
* 높은 전환 비용
	* JDBC/JPA/Mybatis > R2DBC
	
***
> 출처<br>
> https://techblog.woowahan.com/2619/
> https://juneyr.dev/reactive-programming
> https://dzone.com/articles/raw-performance-numbers-spring-boot-2-webflux-vs-s
> https://devahea.github.io/2019/04/21/Spring-WebFlux%EB%8A%94-%EC%96%B4%EB%96%BB%EA%B2%8C-%EC%A0%81%EC%9D%80-%EB%A6%AC%EC%86%8C%EC%8A%A4%EB%A1%9C-%EB%A7%8E%EC%9D%80-%ED%8A%B8%EB%9E%98%ED%94%BD%EC%9D%84-%EA%B0%90%EB%8B%B9%ED%95%A0%EA%B9%8C/
> https://poiemaweb.com/js-event