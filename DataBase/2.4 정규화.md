# 이상현상
> 예시 테이블 : 회원정보 테이블과 주문정보 테이블을 분리없이 하나의 테이블로 관리중 

<img src="https://user-images.githubusercontent.com/48702893/109316530-0e452100-788f-11eb-8ac3-a489072e82c2.jpg" width="500" height="100">

### 삽입이상
* 데이터 삽입시 원하지 않는 데이터들도 삽입이 강제되어 불필요하게 NULL 로 삽입하게되는 현상
* 신규 회원이 가입하여 회원 정보를 테이블에 삽입시, 아직 회원의 주문정보가 없음에도 주문정보 삽입이 강제되어 NULL 로 삽입 

<img src="https://user-images.githubusercontent.com/48702893/109316867-654af600-788f-11eb-916b-37dade615a0d.jpg" width="500" height="100">


### 삭제이상
* 데이터 삭제시 유용한 데이터까지 함께 삭제되는 현상 
* 회원이 주문을 취소하여 주문정보 삭제시, 회원 정보까지 함께 삭제되어 회원 정보 유실 발생 

<img src="https://user-images.githubusercontent.com/48702893/109316503-0a190380-788f-11eb-8c29-19425f117213.jpg" width="500" height="100">


### 수정이상
* 중복 데이터가 존재하여, 데이터 수정시, 중복 데이터중 일부만 수정되어 데이터 불일치 발생
* 회원의 주소정보 수정시, 동일한 회원정보가 저장되어있는 다른 행은 수정되지 않아 주소정보의 불일치 발생 

<img src="https://user-images.githubusercontent.com/48702893/109316496-084f4000-788f-11eb-8b03-ae336c43df9f.jpg" width="500" height="100">

<br>

# 정규화
* 테이블 분리를 통해 이상현상을 해결하여 데이터 중복을 최소화하는 과정

### 제 1 정규형
* 모든 속성의 도메인은 원자값으로 구성되어있어야 한다
> 모든 칼럼값이 단일 값으로 이루어져 있어야 한다.

#### 위반
* 주문 항목 칼럼값이 원자값이 아닌 row 존재 (3 운영체제, 4 네트워크)

![image](https://user-images.githubusercontent.com/48702893/109381313-0a5fe000-791d-11eb-8634-88b8123937bf.png)

#### 수정
* 원자 값이 아닌 row 를 원자값이 되도록 row 분리 수행
* 더이상 주문번호 칼럼이 기본키가 될 수 없으므로 주문번호, 도서 번호의 복합키를 기본키로 사용

![image](https://user-images.githubusercontent.com/48702893/109381317-1186ee00-791d-11eb-92ed-d94372185720.png)

<br>

### 제 2 정규형
* 키에 속하지 않는 모든 속성은 기본키에 완전 함수 종속적이어야 한다
* 기본키가 복합키일때, 기본키를 구성하는 속성과 일반속성 사이에 종속관계가 있을경우 분리 필요
> 기본키가 단일키 일경우 제 2 정규화 불필요

#### 위반
* 주문일자, 회원번호, 회원명, 주소 속성은 기본키 구성요소인 주문번호속성에 종속적
* 도서명은 또다른 기본키 구성요소인 도서 번호 속성에 종속적

![image](https://user-images.githubusercontent.com/48702893/109381317-1186ee00-791d-11eb-92ed-d94372185720.png)

#### 수정
* 각각의 종속관계를 가지는 기본키 칼럼과 피종속칼럼들을 별도의 테이블로 분리
* 기존 테이블에는 기본키 칼럼들만 둠으로서 데이터 중복 최소화 

![image](https://user-images.githubusercontent.com/48702893/109381593-a3432b00-791e-11eb-888b-41f7c85cdaa9.png)

![image](https://user-images.githubusercontent.com/48702893/109381603-afc78380-791e-11eb-8bd4-52bc56d848b9.png)

![image](https://user-images.githubusercontent.com/48702893/109381597-a9390c00-791e-11eb-9f5b-e1d41e09299d.png)

<br>

### 제 3 정규형
* 키에 속하지 않는 모든 속성은 기본키에 이행적 함수 종속적이지 않아야 한다.
* 기본키가 아닌 속성들간의 종속관계가 존재할시 이를 별도의 테이블로 분리

#### 위반
* 기본키가 아닌 일반속성인 회원번호와 또다른 일반속성인 회원명, 주소 간의 종속관계 성립

![image](https://user-images.githubusercontent.com/48702893/109381597-a9390c00-791e-11eb-9f5b-e1d41e09299d.png)

#### 수정
* 종속관계를 가지는 속성들을 별도의 테이블로 분리

![image](https://user-images.githubusercontent.com/48702893/109382336-25355300-7923-11eb-9af2-bcad85e41bb1.png)

![image](https://user-images.githubusercontent.com/48702893/109382342-2cf4f780-7923-11eb-9aad-38492b96bfb6.png)

<br>

### BCNF 정규형
* 제 3 정규형을 만족하면서 릴레이션의 모든 결정자가 후보키 집합에 속해있어야한다.
* 릴레이션의 후보키가 아니면서 다른 속성값을 결정하는 속성이 없어야 함

#### 위반
* 테이블의 후보키는 (학생번호, 강의명), (학생번호, 교수명) 2개 존재
* 교수명 속성은 후보키가 아니면서 강의명 속성값을 결정하는 결정자

![image](https://user-images.githubusercontent.com/48702893/109382961-cd98e680-7926-11eb-9331-06aecf76a9fc.png)

#### 수정
* 후보키가 아니면서 결정자인 속성과 그 피결정 속성을 별도의 테이블로 분리

![image](https://user-images.githubusercontent.com/48702893/109382963-d5f12180-7926-11eb-8d9e-583fb2abee1b.png)

![image](https://user-images.githubusercontent.com/48702893/109382965-dbe70280-7926-11eb-9d1c-4a741a0cabb7.png) 

<br>

### 그 이상의 정규형
* 일반적으로 BCNF 정규형까지 만족하는 릴레이션은 대부분 4,5,6 정규형도 만족
* 제 4 정규형 : 릴레이션에 다치 종속성 X -> Y 이 존재할때, 릴레이션의 모든 속성이 X에 종속적이어야 한다.
* 제 5 정규형 : 릴레이션에 존재하는 모든 조인 종속은 릴레이션의 후보키를 통해서만 성립되어야 한다. 

### 역정규화
* 정규화를 통해 지나치게 테이블들을 잘게 쪼개놓은경우, 조회쿼리 수행시 JOIN 이 너무 많아져 오히려 쿼리 성능이 떨어지는 문제 발생
* JOIN 이 많이 수행되는 테이블들의 경우 역졍규화를 통해 다시 테이블을 통합하여 쿼리 성능 개선